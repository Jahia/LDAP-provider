<div class="section"><h2>Jahia LDAP Connector<a name="Jahia_LDAP_Connector"></a></h2><div class="section"><h3>Overview<a name="Overview"></a></h3><p>This module provides LDAP provider implementations for user and user groups. From version 6.5 up Jahia supports multiple LDAP providers to be used simultaneously to achieve better flexibility and data aggregation. </p></div><div class="section"><h3>Registering LDAP providers<a name="Registering_LDAP_providers"></a></h3><p>The following steps show how to enable and configure the user and user group LDAP providers declaring them in a custom Jahia module.</p><ol style="list-style-type: decimal"><li>Create the following folder structure for your module:<div class="source"><pre>  META-INF
     | + spring
     |     | - users-ldap.xml
     |     | - groups-ldap.xml
     | - MANIFEST.MF</pre></div></li><li>The content of the <tt>MANIFEST.MF</tt> file should include three mandatory attributes:<div class="source"><pre>  ...
  depends: Jahia LDAP connector
  package-name: My Custom LDAP Provider
  root-folder: my-custom-ldap-provider
  ...</pre></div><p><tt>depends</tt> attribute defines a dependency to the <i>Jahia LDAP connector</i> module (this module).</p><p><tt>package-name</tt> specifies your module ID</p><p><tt>root-folder</tt> contains the name of the folder, the content of the module will be extracted into (a sub-folder of the <tt>/modules</tt> folder). </p><p>All other attributes in <tt>MANIFEST.MF</tt> file are optional. </p></li><li>LDAP user provide configuration in <tt>users-ldap.xml</tt><p>The file contains a Spring bean definition for the user provider as follows:</p><div class="source"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;&gt;

    &lt;bean parent=&quot;JahiaUserManagerLDAPProvider&quot;&gt;
        &lt;property name=&quot;ldapProperties&quot;&gt;
            &lt;map&gt;
                &lt;entry key=&quot;url&quot; value=&quot;ldap://127.0.0.1:389/&quot;/&gt;
                &lt;entry key=&quot;public.bind.dn&quot; value=&quot;&quot;/&gt;
                &lt;entry key=&quot;public.bind.password&quot; value=&quot;&quot;/&gt;
                &lt;entry key=&quot;uid.search.name&quot; value=&quot;dc=jahia&quot;/&gt;
            &lt;/map&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    
&lt;/beans&gt;</pre></div><p>The bean has <tt>JahiaUserManagerLDAPProvider</tt> as its parent and should override at least the <tt>ldapProperties</tt> property to properly configure connector and LDAP attribute mapping. Default LDAP parameter values are defined in parent and can be overridden in the <tt>ldapProperties</tt> map. See <a href="#User"> property reference</a> for more details.</p><p>In case multiple LDAP user providers are used, additionally two properties need to be provided to specify a unique provider key and a priority (lookup sequence):</p><div class="source"><pre>...
    &lt;bean parent=&quot;JahiaUserManagerLDAPProvider&quot;&gt;
        &lt;property name=&quot;key&quot; value=&quot;myldap&quot;/&gt;
        &lt;property name=&quot;priority&quot; value=&quot;2&quot;/&gt;
    ...
    &lt;/bean&gt;
...</pre></div><p>The <tt>users-ldap.xml</tt> file name is arbitrary and the file itself can be omitted, if no LDAP user provider is needed.</p></li><li>LDAP user group provide configuration in <tt>groups-ldap.xml</tt><p>The file contains a Spring bean definition for the user group provider as follows:</p><div class="source"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;&gt;

    &lt;bean parent=&quot;JahiaGroupManagerLDAPProvider&quot;&gt;
        &lt;property name=&quot;ldapProperties&quot;&gt;
            &lt;map&gt;
                &lt;entry key=&quot;url&quot; value=&quot;ldap://127.0.0.1:389/&quot;/&gt;
                &lt;entry key=&quot;public.bind.dn&quot; value=&quot;&quot;/&gt;
                &lt;entry key=&quot;public.bind.password&quot; value=&quot;&quot;/&gt;
                &lt;entry key=&quot;search.name&quot; value=&quot;dc=jahia&quot;/&gt;
            &lt;/map&gt;
        &lt;/property&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</pre></div><p>The bean has <tt>JahiaGroupManagerLDAPProvider</tt> as its parent and should override at least the <tt>ldapProperties</tt> property to properly configure connector and LDAP attribute mapping. Default LDAP parameter values are defined in parent and can be overridden in the <tt>ldapProperties</tt> map. See <a href="#group"> property reference</a> for more details.</p><p>In case multiple LDAP user group providers are used, additionally two properties need to be provided to specify a unique provider key and a priority (lookup sequence):</p><div class="source"><pre>...
    &lt;bean parent=&quot;JahiaGroupManagerLDAPProvider&quot;&gt;
        &lt;property name=&quot;key&quot; value=&quot;myldap&quot;/&gt;
        &lt;property name=&quot;priority&quot; value=&quot;2&quot;/&gt;
    ...
    &lt;/bean&gt;
...</pre></div><p>The <tt>groups-ldap.xml</tt> file name is arbitrary and the file itself can be omitted, if no LDAP user provider is needed.</p></li><li>Zip the content of your module into a file with <tt>.war</tt>, e.g. <tt>my-custom-ldap-provider.war</tt></li><li>Copy the module WAR file into the <tt>WEB-INF/var/shared_module</tt> folder of your server (all cluster nodes)</li><li>If the module hot deployment is enabled the providers will be registered automatically. Otherwise a server restart is required for a module to be deployed and providers to be registered.</li></ol></div><div class="section"><h3><a name="User">User</a> provider properties reference<a name="User_provider_properties_reference"></a></h3><p>The following LDAP properties can be specified in the <tt>ldapProperties</tt> map to customize the user provider configuration:</p><ol style="list-style-type: upper-roman"><li>Connection and authentication parameters<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>url</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The LDAP connection URL, e.g. <tt>ldap://127.0.0.1:389/</tt></td></tr><tr class="a"><td align="left"><tt>public.bind.dn</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">This is the user on the LDAP server permitted to search the LDAP directory within the defined search base.</td></tr><tr class="b"><td align="left"><tt>public.bind.password</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The password, used to authenticate searches in LDAP directory</td></tr><tr class="a"><td align="left"><tt>authentification.mode</tt></td><td align="left"><tt>simple</tt></td><td align="left">LDAP directory authentication type</td></tr><tr class="b"><td align="left"><tt>context.factory</tt></td><td align="left"><tt>com.sun.jndi.ldap.LdapCtxFactory</tt></td><td align="left">The implementation class for context factory to use</td></tr><tr class="a"><td align="left"><tt>ldap.connect.pool</tt></td><td align="left"><tt>true</tt></td><td align="left">Enables/disables <a class="externalLink" href="http://download.oracle.com/javase/jndi/tutorial/ldap/connect/pool.html">connection pooling</a></td></tr><tr class="b"><td align="left"><tt>ldap.connect.timeout</tt></td><td align="left"><tt>5000</tt></td><td align="left">When connection pooling has been enabled and no pooled connection is available, the client application will block, waiting for an available connection. Setting this timeout value will specify how long to wait for a pooled connection (in milliseconds). If you omit this property, the application will wait indefinitely. See <a class="externalLink" href="http://download.oracle.com/javase/jndi/tutorial/ldap/connect/pool.html">connection pooling</a> for details.</td></tr><tr class="a"><td align="left"><tt>search.countlimit</tt></td><td align="left"><tt>100</tt></td><td align="left">The number of entries to limit search results to. If the LDAP user search returns more matching entries than specified with this parameter, the first <tt>search.countlimit</tt> will be returned only.</td></tr></table></li><li>Search parameters<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>uid.search.name</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The search base that defines which part of the LDAP directory tree to search, e.g. <tt>dc=jahia,dc=com</tt></td></tr><tr class="a"><td align="left"><tt>uid.search.attribute</tt></td><td align="left"><tt>cn</tt></td><td align="left">The name of the attribute that will be used as a user key.</td></tr><tr class="b"><td align="left"><tt>search.objectclass</tt></td><td align="left"><tt>person</tt></td><td align="left">The <tt>objectClass</tt> value for a user object</td></tr><tr class="a"><td align="left"><tt>search.wildcards.attributes</tt></td><td align="left"><tt>ou, cn, o, c, mail, uid, uniqueIdentifier, givenName, sn, dn</tt></td><td align="left">A list of attributes to use for wildcard searches such as <i>*=*test*</i></td></tr></table></li><li>Attribute mapping parameters - defines a mapping between Jahia's <tt>jnt:user</tt> node properties and the corresponding LDAP object attributes.<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>j:firstName.attribute.map</tt></td><td align="left"><tt>givenName</tt></td><td align="left">First name</td></tr><tr class="a"><td align="left"><tt>j:lastName.attribute.map</tt></td><td align="left"><tt>sn</tt></td><td align="left">Second name</td></tr><tr class="b"><td align="left"><tt>j:email.attribute.map</tt></td><td align="left"><tt>mail</tt></td><td align="left">User's e-mail address</td></tr><tr class="a"><td align="left"><tt>j:organization.attribute.map</tt></td><td align="left"><tt>ou</tt></td><td align="left">The name of the organization</td></tr></table><p>Additional attribute mappings can be specified, using the following pattern for the entry key: &quot;<tt>&lt;jahia-user-property-name&gt;.attribute.map</tt>&quot; and the name of the corresponding LDAP object attribute as the value.</p></li></ol></div><div class="section"><h3>User <a name="group">group</a> provider properties reference<a name="User_group_provider_properties_reference"></a></h3><p>The following LDAP properties can be specified in the <tt>ldapProperties</tt> map to customize the group provider configuration:</p><ol style="list-style-type: upper-roman"><li>Connection and authentication parameters<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>url</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The LDAP connection URL, e.g. <tt>ldap://127.0.0.1:389/</tt></td></tr><tr class="a"><td align="left"><tt>public.bind.dn</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">This is the user on the LDAP server permitted to search the LDAP directory within the defined search base.</td></tr><tr class="b"><td align="left"><tt>public.bind.password</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The password, used to authenticate searches in LDAP directory</td></tr><tr class="a"><td align="left"><tt>authentification.mode</tt></td><td align="left"><tt>simple</tt></td><td align="left">LDAP directory authentication type</td></tr><tr class="b"><td align="left"><tt>context.factory</tt></td><td align="left"><tt>com.sun.jndi.ldap.LdapCtxFactory</tt></td><td align="left">The implementation class for context factory to use</td></tr><tr class="a"><td align="left"><tt>ldap.connect.pool</tt></td><td align="left"><tt>true</tt></td><td align="left">Enables/disables <a class="externalLink" href="http://download.oracle.com/javase/jndi/tutorial/ldap/connect/pool.html">connection pooling</a></td></tr><tr class="b"><td align="left"><tt>ldap.connect.timeout</tt></td><td align="left"><tt>5000</tt></td><td align="left">When connection pooling has been enabled and no pooled connection is available, the client application will block, waiting for an available connection. Setting this timeout value will specify how long to wait for a pooled connection (in milliseconds). If you omit this property, the application will wait indefinitely. See <a class="externalLink" href="http://download.oracle.com/javase/jndi/tutorial/ldap/connect/pool.html">connection pooling</a> for details.</td></tr></table></li><li>Search and membership parameters<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>preload</tt></td><td align="left"><tt>false</tt></td><td align="left">If set to <tt>true</tt> forces the reading of all group members when a group is retrieved. Otherwise group members will be read when a first request for user membership will be made</td></tr><tr class="a"><td align="left"><tt>search.countlimit</tt></td><td align="left"><tt>100</tt></td><td align="left">The number of entries to limit search results to. If the LDAP user search returns more matching entries than specified with this parameter, the first <tt>search.countlimit</tt> will be returned only.</td></tr><tr class="b"><td align="left"><tt>refferal</tt></td><td align="left"><tt>ignore</tt></td><td align="left">Specifies how referrals encountered by the service provider are to be processed. P&#xfffd;ossible values are <tt>follow</tt> - follow referrals automatically, <tt>ignore</tt> - ignore referrals, <tt>throw</tt> - throw <tt>ReferralException</tt> when a referral is encountered</td></tr><tr class="a"><td align="left"><tt>ad.range.step</tt></td><td align="left"><tt>0</tt></td><td align="left">Handle Active Directory range searches when retrieving group members. If set to <tt>0</tt> all members are retrieved with a single search. If set e.g. to <tt>100</tt>, searches like <tt>range=0-100</tt>, <tt>range=101-200</tt>, <tt>range=201-300</tt> etc. are used to retrieve all members iteratively.</td></tr><tr class="b"><td align="left"><tt>search.name</tt></td><td align="left"><tt>&lt;none&gt;</tt></td><td align="left">The search base that defines which part of the LDAP directory tree to search, e.g. <tt>dc=jahia,dc=com</tt></td></tr><tr class="a"><td align="left"><tt>search.attribute</tt></td><td align="left"><tt>cn</tt></td><td align="left">The name of the attribute that will be used as a user key.</td></tr><tr class="b"><td align="left"><tt>search.objectclass</tt></td><td align="left"><tt>groupOfUniqueNames</tt></td><td align="left">The <tt>objectClass</tt> value for a group object</td></tr><tr class="a"><td align="left"><tt>search.wildcards.attributes</tt></td><td align="left"><tt>cn,description,uniqueMember</tt></td><td align="left">A list of attributes to use for wildcard searches such as <i>*=*test*</i></td></tr><tr class="b"><td align="left"><tt>members.attribute</tt></td><td align="left"><tt>uniqueMember</tt></td><td align="left">The name of the LDAP group object attribute to retrieve membership from</td></tr><tr class="a"><td align="left"><tt>dynamic.search.objectclass</tt></td><td align="left"><tt>groupOfURLs</tt></td><td align="left">The name of the LDAP group object attribute to retrieve dynamic membership from</td></tr><tr class="b"><td align="left"><tt>dynamic.members.attribute</tt></td><td align="left"><tt>memberurl</tt></td><td align="left">The name of the LDAP group object attribute to retrieve dynamic membership from</td></tr></table></li><li>Attribute mapping parameters - defines a mapping between Jahia's <tt>jnt:user</tt> node properties and the corresponding LDAP object attributes.<table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Key</b></td><td align="left"><b>Default value</b></td><td align="left"><b>Description</b></td></tr><tr class="b"><td align="left"><tt>groupname.attribute.map</tt></td><td align="left"><tt>cn</tt></td><td align="left">Group name</td></tr><tr class="a"><td align="left"><tt>description.attribute.map</tt></td><td align="left"><tt>description</tt></td><td align="left">Description</td></tr></table><p>Additional attribute mappings can be specified, using the following pattern for the entry key: &quot;<tt>&lt;jahia-group-property-name&gt;.attribute.map</tt>&quot; and the name of the corresponding LDAP object attribute as the value.</p></li></ol></div></div>
      </div>
    </div>
